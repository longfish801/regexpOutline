# regexpOutline README

## 機能

見出しのフォーマットを正規表現で指定することでアウトラインを生成します。

* 以下のケースで利用することを想定しています。
    - プレーンテキストであってもアウトラインを生成したい場合。
    - 独自の仕様といった事情でアウトラインを生成する拡張機能がない場合。
* ファイルの拡張子毎に見出しのルールを指定します。
* 見出しのフォーマットは正規表現で指定します。  
  見出しとして表示する箇所はグループで指定できます。
* ファイルの先頭と終端にも見出しを生成します。
* 複雑な構文には対応していません。
  - 単一行の見出しを想定しています。  
  - たとえばコードサンプルなどに正規表現と偶然にも一致する行があれば見出しとみなされます。

日本のエディタ（秀丸エディタ、サクラエディタ、WZ EDITORなど）では当然のように実装されている機能です。
なぜかVSCodeには実装されていないため作成しました。

## 拡張機能の設定
### 設定サンプル

設定項目「拡張子毎の見出しルール」を設定してください。  
デフォルトのままでは動作しません。

たとえば以下のアウトラインを作成したいとします。  
レベル1はHTMLのH1タグ（最上位の見出し）に相当します。

* ファイル拡張子が ".txt"のファイルを対象としたい。
* 行頭が「■」始まりならばレベル1の見出し。
* 行頭が「□」始まりならばレベル2の見出し。
* 行頭が「▼」始まりならばレベル3の見出し。
* 行頭記号より後の文字列を見出しの文字列にする。
* ファイルの先頭、末尾もアウトラインに表示する。

以下のようにJSON形式で見出しのルールを作成してください。  

```
[
    {
        "ext": ".txt",
        "bullets": [
            "■",
            "□",
            "▼"
        ]
    }
]
```

これを改行コードやインデントを取り除いて一行に圧縮した文字列を設定項目「拡張子毎の見出しルール」に設定してください。  
一行に圧縮することはVSCodeの機能 "Join Lines"を使うなどしてください。

```
[ { "ext": ".txt", "bullets": ["■", "□", "▼"] } ]
```

上記の設定は、以下と同じ意味です。

```
[
    {
        "ext": ".txt",
        "rules": [
            {
                "level": 1,
                "format": "^■(.+)$"
            },
            {
                "level": 2,
                "format": "^□(.+)$"
            },
            {
                "level": 3,
                "format": "^▼(.+)$"
            }
        ]
    }
]
```

以下の点に注意してください。

* JSONでは特殊な文字をエスケープする必要があります。
* 直接settings.jsonに設定することはお勧めしません。
  - JSONではなく、JSONをエスケープして文字列にする必要があります。

#### キーの詳細

各キーの意味は以下のとおりです。

* ext
  - ファイルの拡張子  
    ここに指定した値がファイル名と終端一致したならば対象とみなします。  
    必須です。
* bullets
  - 行頭記号のリストです。  
    一番目の要素に"■"を設定すると、rulesの一番目のlevelに1を、formatに"^■(.+)$"を指定するのと同じことになります。  
    上記の設定例を参照してください。  
    省略可です。  
    設定すると rulesは無効になります。
* showTOF
  - アウトラインの先頭に TOF (Top Of File)を表示するか否か。  
    boolean型、デフォルト値は trueです。
* showEOF
  - アウトラインの末尾に EOF (End Of File)を表示するか否か。  
    boolean型、デフォルト値は trueです。
* rules / level
  - 見出しのレベルです。  
    必須です。
* rules / format
  - 見出しのフォーマットです。  
    正規表現で指定してください。  
    必須です。
* rules / nameIdx
  - 見出し文字列として表示するグループの番号です。  
    デフォルトは 1です。  
    なお 0を指定した場合は formatで一致した全体が見出し文字列になります。
* rules / detail
  - 見出しに詳細として表示する文字列です。  
    デフォルトは空文字です。

#### showTOF, showEOFについて

見出しがたまたまファイルの一行目にあると、アウトラインにその見出しがTOFより上に表示されることがあります（EOFも同様）。  
この問題は解決できていません。見出しの行の位置が同じとき、アウトラインでの表示順序は VSCode本体側で制御されるためです。  
せめて TOF, EOFを非表示にする機能を設けました。
